# layerzero_merkly_sybil
The repository is used to verify malicious use of merkly, launch layerzero's witch attack, and partially verify witch addresses  
  
1.The analysis covers most of the **major EVM chains**: Ethereum, Arbitrum, Optimism, Base, Polygon, Zksync, Linea, Scorll, blast, Mode, Avax, Bnb, Moonbeam, Opbnb, Moonriver;  
  
2.The analysis determines address witches by:  
    &nbsp;&nbsp;1.Used merkly;  
    &nbsp;&nbsp;2.The **total tx** number of wallet addresses in these chains;  
    &nbsp;&nbsp;3.The **total gas balance** of the wallet address in these chains;  
    &nbsp;&nbsp;4.The **creation age** of the wallet address;  
    &nbsp;&nbsp;5.How many **chains are used** in the wallet address;  
    &nbsp;&nbsp;6.Whether the last transaction and the first transaction of the wallet address are more than **3 months ago** or whether they have been used more than **21 days**.  
      
3.Specific decision Decision address witch rules:  
    &nbsp;&nbsp;1. First of all, due to conditions, we can only scan **polygon blocks in merkly** to obtain potential addresses;  
    &nbsp;&nbsp;2. Then use getAddressAge to obtain whether the initial creation date of the user address is **>1 year**;  
    &nbsp;&nbsp;3, if the user's date **<=1 year**, the total tx of the user in these **chains <200 and the chain used <=2**, and then determine the user's **total balance gas<10** is a potential witch;   
    &nbsp;&nbsp;If the user's date is **>1 year**, then the user's total tx in these **chains is <300 and the chain used is <=3**, and then the user's **total balance gas<10** is a potential witch;  
    &nbsp;&nbsp;4. Due to the limited data returned, sybilAddress, a suspect address group, was generated by using the for loop to push the potential witch address to the **waitAddress${page}.csv**   
    file of each data page;  
    &nbsp;&nbsp;5. Then call aggregatedCsv through judge.js to integrate the potential witch address group into the **AggregatedWaitSybilGroup.csv**;  
    &nbsp;&nbsp;6, through getTransactionService to find out whether the **user's latest transaction > the first transaction three months**;  
    &nbsp;&nbsp;7. Run getUserActiveDays to obtain the **active days of polygon's address**.  
    &nbsp;&nbsp;8. When the last transaction of the potential witch address read is **<=3 months away from the first transaction or the active days in polygon are <=21 days, then it is screened  
    whether it is one of the more than 80 w addresses published by layerzero, and determines whether the addresses are repeated, and finally generates the witch list sybilData.csv**   
